"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/stream/route";
exports.ids = ["app/api/stream/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2Froute&page=%2Fapi%2Fstream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2Froute.ts&appDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2Froute&page=%2Fapi%2Fstream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2Froute.ts&appDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_michalwanto_Documents_Michal_wanto_Work_Synergy_test_Transactional_agent_src_app_api_stream_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/stream/route.ts */ \"(rsc)/./src/app/api/stream/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/stream/route\",\n        pathname: \"/api/stream\",\n        filename: \"route\",\n        bundlePath: \"app/api/stream/route\"\n    },\n    resolvedPagePath: \"/Users/michalwanto/Documents/Michal_wanto/Work/Synergy_test/Transactional_agent/src/app/api/stream/route.ts\",\n    nextConfigOutput,\n    userland: _Users_michalwanto_Documents_Michal_wanto_Work_Synergy_test_Transactional_agent_src_app_api_stream_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/stream/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdHJlYW0lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN0cmVhbSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN0cmVhbSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1pY2hhbHdhbnRvJTJGRG9jdW1lbnRzJTJGTWljaGFsX3dhbnRvJTJGV29yayUyRlN5bmVyZ3lfdGVzdCUyRlRyYW5zYWN0aW9uYWxfYWdlbnQlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbWljaGFsd2FudG8lMkZEb2N1bWVudHMlMkZNaWNoYWxfd2FudG8lMkZXb3JrJTJGU3luZXJneV90ZXN0JTJGVHJhbnNhY3Rpb25hbF9hZ2VudCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDMkQ7QUFDeEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFuc2FjdGlvbmFsX2FnZW50Lz81MWM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9taWNoYWx3YW50by9Eb2N1bWVudHMvTWljaGFsX3dhbnRvL1dvcmsvU3luZXJneV90ZXN0L1RyYW5zYWN0aW9uYWxfYWdlbnQvc3JjL2FwcC9hcGkvc3RyZWFtL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zdHJlYW0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zdHJlYW1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3N0cmVhbS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy9taWNoYWx3YW50by9Eb2N1bWVudHMvTWljaGFsX3dhbnRvL1dvcmsvU3luZXJneV90ZXN0L1RyYW5zYWN0aW9uYWxfYWdlbnQvc3JjL2FwcC9hcGkvc3RyZWFtL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdHJlYW0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2Froute&page=%2Fapi%2Fstream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2Froute.ts&appDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/agent/index.ts":
/*!****************************!*\
  !*** ./src/agent/index.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TransactionalAgent: () => (/* binding */ TransactionalAgent)\n/* harmony export */ });\n/* harmony import */ var _x402_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../x402/client */ \"(rsc)/./src/x402/client.ts\");\n\nclass TransactionalAgent {\n    // private micropay: MicropayService; \n    constructor(config){\n        // Initialize Micropay (Mock for now as per plan)\n        // this.micropay = new MockMicropayService();\n        // Initialize Wallet\n        if (config.useRealWallet && config.privateKey) {\n            console.log(\"[Agent] \\uD83D\\uDD10 Initializing Real Wallet...\");\n            let pk = config.privateKey.trim();\n            // Prefix check is handled inside RealWallet now, but safe to keep or remove.\n            // keeping it simple.\n            this.wallet = new _x402_client__WEBPACK_IMPORTED_MODULE_0__.RealWallet(pk, config.rpcUrl);\n        } else {\n            console.log(\"[Agent] ‚ö†Ô∏è Real Wallet required for RailBridge Integration.\");\n            throw new Error(\"Real Wallet required for RailBridge Integration\");\n        }\n    }\n    /**\n     * Executes the main agent workflow: Check -> Pay\n     */ async run(logCallback) {\n        const log = (msg)=>{\n            console.log(msg); // Keep server console log\n            if (logCallback) logCallback(msg);\n        };\n        log(\"-----------------------------------------\");\n        log(\"\\uD83E\\uDD16 Synergy Agent Starting (RailBridge x402 Mode)...\");\n        log(\"-----------------------------------------\");\n        // 1. Initialize X402 Client\n        // Pointing to RailBridge Merchant Server on Port 4021\n        const merchantUrl = \"http://localhost:4021\";\n        const x402 = new _x402_client__WEBPACK_IMPORTED_MODULE_0__.X402Client(merchantUrl, this.wallet, log);\n        // 2. Execution Loop\n        try {\n            log(`[Agent] üéØ Task: Access Premium Content at ${merchantUrl}/api/premium`);\n            log(`[Agent] üöÄ Sending GET request...`);\n            // This single line triggers the entire 402 negotiation flow\n            const response = await x402.get(\"/api/premium\");\n            log(\"-----------------------------------------\");\n            log(\"‚úÖ AGENT SUCCESS\");\n            log(`[HTTP ${response.status}] üü¢ Content Access Granted`);\n            if (response.data && typeof response.data === \"object\") {\n                log(`Content Accessed: \"${response.data.message}\"`);\n                log(`Data: ${JSON.stringify(response.data.data)}`);\n            } else {\n                log(`Data: ${response.data}`);\n            }\n            log(\"-----------------------------------------\");\n            return \"SUCCESS\";\n        } catch (error) {\n            log(`[Agent] ‚ùå Agent Failed: ${error.message}`);\n            if (error.response) {\n                log(`[Agent] Status: ${error.response.status}`);\n                log(`[Agent] Data: ${JSON.stringify(error.response.data)}`);\n            }\n            throw error;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYWdlbnQvaW5kZXgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDd0Q7QUFTakQsTUFBTUU7SUFFVCxzQ0FBc0M7SUFFdENDLFlBQVlDLE1BQW1CLENBQUU7UUFDN0IsaURBQWlEO1FBQ2pELDZDQUE2QztRQUU3QyxvQkFBb0I7UUFDcEIsSUFBSUEsT0FBT0MsYUFBYSxJQUFJRCxPQUFPRSxVQUFVLEVBQUU7WUFDM0NDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLElBQUlDLEtBQUtMLE9BQU9FLFVBQVUsQ0FBQ0ksSUFBSTtZQUMvQiw2RUFBNkU7WUFDN0UscUJBQXFCO1lBQ3JCLElBQUksQ0FBQ0MsTUFBTSxHQUFHLElBQUlYLG9EQUFVQSxDQUFDUyxJQUFJTCxPQUFPUSxNQUFNO1FBQ2xELE9BQU87WUFDSEwsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTSxJQUFJSyxNQUFNO1FBQ3BCO0lBQ0o7SUFFQTs7S0FFQyxHQUNELE1BQU1DLElBQUlDLFdBQW1DLEVBQUU7UUFDM0MsTUFBTVAsTUFBTSxDQUFDUTtZQUNUVCxRQUFRQyxHQUFHLENBQUNRLE1BQU0sMEJBQTBCO1lBQzVDLElBQUlELGFBQWFBLFlBQVlDO1FBQ2pDO1FBRUFSLElBQUk7UUFDSkEsSUFBSTtRQUNKQSxJQUFJO1FBRUosNEJBQTRCO1FBQzVCLHNEQUFzRDtRQUN0RCxNQUFNUyxjQUFjO1FBQ3BCLE1BQU1DLE9BQU8sSUFBSWpCLG9EQUFVQSxDQUFDZ0IsYUFBYSxJQUFJLENBQUNOLE1BQU0sRUFBRUg7UUFFdEQsb0JBQW9CO1FBQ3BCLElBQUk7WUFDQUEsSUFBSSxDQUFDLDJDQUEyQyxFQUFFUyxZQUFZLFlBQVksQ0FBQztZQUMzRVQsSUFBSSxDQUFDLGlDQUFpQyxDQUFDO1lBRXZDLDREQUE0RDtZQUM1RCxNQUFNVyxXQUFXLE1BQU1ELEtBQUtFLEdBQUcsQ0FBQztZQUVoQ1osSUFBSTtZQUNKQSxJQUFJO1lBQ0pBLElBQUksQ0FBQyxNQUFNLEVBQUVXLFNBQVNFLE1BQU0sQ0FBQywyQkFBMkIsQ0FBQztZQUV6RCxJQUFJRixTQUFTRyxJQUFJLElBQUksT0FBT0gsU0FBU0csSUFBSSxLQUFLLFVBQVU7Z0JBQ3BEZCxJQUFJLENBQUMsbUJBQW1CLEVBQUVXLFNBQVNHLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDbERmLElBQUksQ0FBQyxNQUFNLEVBQUVnQixLQUFLQyxTQUFTLENBQUNOLFNBQVNHLElBQUksQ0FBQ0EsSUFBSSxFQUFFLENBQUM7WUFDckQsT0FBTztnQkFDSGQsSUFBSSxDQUFDLE1BQU0sRUFBRVcsU0FBU0csSUFBSSxDQUFDLENBQUM7WUFDaEM7WUFFQWQsSUFBSTtZQUNKLE9BQU87UUFDWCxFQUFFLE9BQU9rQixPQUFZO1lBQ2pCbEIsSUFBSSxDQUFDLHdCQUF3QixFQUFFa0IsTUFBTUgsT0FBTyxDQUFDLENBQUM7WUFDOUMsSUFBSUcsTUFBTVAsUUFBUSxFQUFFO2dCQUNoQlgsSUFBSSxDQUFDLGdCQUFnQixFQUFFa0IsTUFBTVAsUUFBUSxDQUFDRSxNQUFNLENBQUMsQ0FBQztnQkFDOUNiLElBQUksQ0FBQyxjQUFjLEVBQUVnQixLQUFLQyxTQUFTLENBQUNDLE1BQU1QLFFBQVEsQ0FBQ0csSUFBSSxFQUFFLENBQUM7WUFDOUQ7WUFDQSxNQUFNSTtRQUNWO0lBRUo7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYW5zYWN0aW9uYWxfYWdlbnQvLi9zcmMvYWdlbnQvaW5kZXgudHM/YjAwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFJlYWxXYWxsZXQsIFg0MDJDbGllbnQgfSBmcm9tICcuLi94NDAyL2NsaWVudCc7XG5pbXBvcnQgeyBNb2NrTWljcm9wYXlTZXJ2aWNlLCBNaWNyb3BheVNlcnZpY2UgfSBmcm9tICcuLi9taWNyb3BheS9zZXJ2aWNlJztcblxuZXhwb3J0IGludGVyZmFjZSBBZ2VudENvbmZpZyB7XG4gICAgcHJpdmF0ZUtleT86IHN0cmluZztcbiAgICBycGNVcmw/OiBzdHJpbmc7XG4gICAgdXNlUmVhbFdhbGxldDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIFRyYW5zYWN0aW9uYWxBZ2VudCB7XG4gICAgcHJpdmF0ZSB3YWxsZXQ6IFJlYWxXYWxsZXQ7XG4gICAgLy8gcHJpdmF0ZSBtaWNyb3BheTogTWljcm9wYXlTZXJ2aWNlOyBcblxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZzogQWdlbnRDb25maWcpIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBNaWNyb3BheSAoTW9jayBmb3Igbm93IGFzIHBlciBwbGFuKVxuICAgICAgICAvLyB0aGlzLm1pY3JvcGF5ID0gbmV3IE1vY2tNaWNyb3BheVNlcnZpY2UoKTtcblxuICAgICAgICAvLyBJbml0aWFsaXplIFdhbGxldFxuICAgICAgICBpZiAoY29uZmlnLnVzZVJlYWxXYWxsZXQgJiYgY29uZmlnLnByaXZhdGVLZXkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW0FnZW50XSDwn5SQIEluaXRpYWxpemluZyBSZWFsIFdhbGxldC4uLlwiKTtcbiAgICAgICAgICAgIGxldCBwayA9IGNvbmZpZy5wcml2YXRlS2V5LnRyaW0oKTtcbiAgICAgICAgICAgIC8vIFByZWZpeCBjaGVjayBpcyBoYW5kbGVkIGluc2lkZSBSZWFsV2FsbGV0IG5vdywgYnV0IHNhZmUgdG8ga2VlcCBvciByZW1vdmUuXG4gICAgICAgICAgICAvLyBrZWVwaW5nIGl0IHNpbXBsZS5cbiAgICAgICAgICAgIHRoaXMud2FsbGV0ID0gbmV3IFJlYWxXYWxsZXQocGssIGNvbmZpZy5ycGNVcmwpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJbQWdlbnRdIOKaoO+4jyBSZWFsIFdhbGxldCByZXF1aXJlZCBmb3IgUmFpbEJyaWRnZSBJbnRlZ3JhdGlvbi5cIik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZWFsIFdhbGxldCByZXF1aXJlZCBmb3IgUmFpbEJyaWRnZSBJbnRlZ3JhdGlvblwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVzIHRoZSBtYWluIGFnZW50IHdvcmtmbG93OiBDaGVjayAtPiBQYXlcbiAgICAgKi9cbiAgICBhc3luYyBydW4obG9nQ2FsbGJhY2s/OiAobXNnOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICAgICAgY29uc3QgbG9nID0gKG1zZzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpOyAvLyBLZWVwIHNlcnZlciBjb25zb2xlIGxvZ1xuICAgICAgICAgICAgaWYgKGxvZ0NhbGxiYWNrKSBsb2dDYWxsYmFjayhtc2cpO1xuICAgICAgICB9O1xuXG4gICAgICAgIGxvZyhcIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXCIpO1xuICAgICAgICBsb2coXCLwn6SWIFN5bmVyZ3kgQWdlbnQgU3RhcnRpbmcgKFJhaWxCcmlkZ2UgeDQwMiBNb2RlKS4uLlwiKTtcbiAgICAgICAgbG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG5cbiAgICAgICAgLy8gMS4gSW5pdGlhbGl6ZSBYNDAyIENsaWVudFxuICAgICAgICAvLyBQb2ludGluZyB0byBSYWlsQnJpZGdlIE1lcmNoYW50IFNlcnZlciBvbiBQb3J0IDQwMjFcbiAgICAgICAgY29uc3QgbWVyY2hhbnRVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6NDAyMVwiO1xuICAgICAgICBjb25zdCB4NDAyID0gbmV3IFg0MDJDbGllbnQobWVyY2hhbnRVcmwsIHRoaXMud2FsbGV0LCBsb2cpO1xuXG4gICAgICAgIC8vIDIuIEV4ZWN1dGlvbiBMb29wXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsb2coYFtBZ2VudF0g8J+OryBUYXNrOiBBY2Nlc3MgUHJlbWl1bSBDb250ZW50IGF0ICR7bWVyY2hhbnRVcmx9L2FwaS9wcmVtaXVtYCk7XG4gICAgICAgICAgICBsb2coYFtBZ2VudF0g8J+agCBTZW5kaW5nIEdFVCByZXF1ZXN0Li4uYCk7XG5cbiAgICAgICAgICAgIC8vIFRoaXMgc2luZ2xlIGxpbmUgdHJpZ2dlcnMgdGhlIGVudGlyZSA0MDIgbmVnb3RpYXRpb24gZmxvd1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB4NDAyLmdldChcIi9hcGkvcHJlbWl1bVwiKTtcblxuICAgICAgICAgICAgbG9nKFwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cIik7XG4gICAgICAgICAgICBsb2coXCLinIUgQUdFTlQgU1VDQ0VTU1wiKTtcbiAgICAgICAgICAgIGxvZyhgW0hUVFAgJHtyZXNwb25zZS5zdGF0dXN9XSDwn5+iIENvbnRlbnQgQWNjZXNzIEdyYW50ZWRgKTtcblxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgJiYgdHlwZW9mIHJlc3BvbnNlLmRhdGEgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgbG9nKGBDb250ZW50IEFjY2Vzc2VkOiBcIiR7cmVzcG9uc2UuZGF0YS5tZXNzYWdlfVwiYCk7XG4gICAgICAgICAgICAgICAgbG9nKGBEYXRhOiAke0pTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEuZGF0YSl9YCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvZyhgRGF0YTogJHtyZXNwb25zZS5kYXRhfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsb2coXCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiKTtcbiAgICAgICAgICAgIHJldHVybiBcIlNVQ0NFU1NcIjtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgbG9nKGBbQWdlbnRdIOKdjCBBZ2VudCBGYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGlmIChlcnJvci5yZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGxvZyhgW0FnZW50XSBTdGF0dXM6ICR7ZXJyb3IucmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgICAgIGxvZyhgW0FnZW50XSBEYXRhOiAke0pTT04uc3RyaW5naWZ5KGVycm9yLnJlc3BvbnNlLmRhdGEpfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cblxuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJSZWFsV2FsbGV0IiwiWDQwMkNsaWVudCIsIlRyYW5zYWN0aW9uYWxBZ2VudCIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwidXNlUmVhbFdhbGxldCIsInByaXZhdGVLZXkiLCJjb25zb2xlIiwibG9nIiwicGsiLCJ0cmltIiwid2FsbGV0IiwicnBjVXJsIiwiRXJyb3IiLCJydW4iLCJsb2dDYWxsYmFjayIsIm1zZyIsIm1lcmNoYW50VXJsIiwieDQwMiIsInJlc3BvbnNlIiwiZ2V0Iiwic3RhdHVzIiwiZGF0YSIsIm1lc3NhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/agent/index.ts\n");

/***/ }),

/***/ "(rsc)/./src/app/api/stream/route.ts":
/*!*************************************!*\
  !*** ./src/app/api/stream/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var _agent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../agent */ \"(rsc)/./src/agent/index.ts\");\n\n// Force dynamic prevents caching\nconst dynamic = \"force-dynamic\";\nasync function GET(request) {\n    console.log(\"API: /api/stream called at \" + new Date().toISOString());\n    const encoder = new TextEncoder();\n    const stream = new ReadableStream({\n        async start (controller) {\n            const privateKey = process.env.PRIVATE_KEY;\n            const rpcUrl = \"https://sepolia.base.org\";\n            // Initialize Agent\n            // NOTE: In a real app, do not expose private key handling this way if possible, or ensure environment is secure.\n            const agent = new _agent__WEBPACK_IMPORTED_MODULE_0__.TransactionalAgent({\n                privateKey: privateKey,\n                // rpcUrl: rpcUrl, // REMOVED: Using default Base Sepolia RPC from client.ts to avoid env var conflict\n                useRealWallet: true\n            });\n            // Log callback to stream data\n            const logCallback = (msg)=>{\n                try {\n                    controller.enqueue(encoder.encode(msg + \"\\n\"));\n                } catch (e) {\n                    // Controller might be closed if client disconnected\n                    console.error(\"Stream closed\", e);\n                }\n            };\n            const runId = Date.now().toString() + \"-\" + Math.floor(Math.random() * 1000);\n            logCallback(`[System] üÜî Run ID: ${runId}`);\n            logCallback(`[System] üïê Time: ${new Date().toISOString()}`);\n            try {\n                await agent.run(logCallback);\n            } catch (e) {\n                logCallback(`[System] ‚ùå Error: ${e.message}`);\n            } finally{\n                controller.close();\n            }\n        }\n    });\n    return new Response(stream, {\n        headers: {\n            \"Content-Type\": \"text/plain; charset=utf-8\",\n            \"Transfer-Encoding\": \"chunked\",\n            \"Cache-Control\": \"no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0\",\n            \"Pragma\": \"no-cache\",\n            \"Expires\": \"0\",\n            \"Connection\": \"keep-alive\",\n            \"X-Accel-Buffering\": \"no\" // Disable Nginx buffering if applicable\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdHJlYW0vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW9EO0FBRXBELGlDQUFpQztBQUMxQixNQUFNQyxVQUFVLGdCQUFnQjtBQUVoQyxlQUFlQyxJQUFJQyxPQUFnQjtJQUN0Q0MsUUFBUUMsR0FBRyxDQUFDLGdDQUFnQyxJQUFJQyxPQUFPQyxXQUFXO0lBQ2xFLE1BQU1DLFVBQVUsSUFBSUM7SUFFcEIsTUFBTUMsU0FBUyxJQUFJQyxlQUFlO1FBQzlCLE1BQU1DLE9BQU1DLFVBQVU7WUFDbEIsTUFBTUMsYUFBYUMsUUFBUUMsR0FBRyxDQUFDQyxXQUFXO1lBQzFDLE1BQU1DLFNBQVNILDBCQUErQjtZQUU5QyxtQkFBbUI7WUFDbkIsaUhBQWlIO1lBQ2pILE1BQU1LLFFBQVEsSUFBSXBCLHNEQUFrQkEsQ0FBQztnQkFDakNjLFlBQVlBO2dCQUNaLHNHQUFzRztnQkFDdEdPLGVBQWU7WUFDbkI7WUFFQSw4QkFBOEI7WUFDOUIsTUFBTUMsY0FBYyxDQUFDQztnQkFDakIsSUFBSTtvQkFDQVYsV0FBV1csT0FBTyxDQUFDaEIsUUFBUWlCLE1BQU0sQ0FBQ0YsTUFBTTtnQkFDNUMsRUFBRSxPQUFPRyxHQUFHO29CQUNSLG9EQUFvRDtvQkFDcER0QixRQUFRdUIsS0FBSyxDQUFDLGlCQUFpQkQ7Z0JBQ25DO1lBQ0o7WUFFQSxNQUFNRSxRQUFRdEIsS0FBS3VCLEdBQUcsR0FBR0MsUUFBUSxLQUFLLE1BQU1DLEtBQUtDLEtBQUssQ0FBQ0QsS0FBS0UsTUFBTSxLQUFLO1lBQ3ZFWCxZQUFZLENBQUMsb0JBQW9CLEVBQUVNLE1BQU0sQ0FBQztZQUMxQ04sWUFBWSxDQUFDLGtCQUFrQixFQUFFLElBQUloQixPQUFPQyxXQUFXLEdBQUcsQ0FBQztZQUUzRCxJQUFJO2dCQUNBLE1BQU1hLE1BQU1jLEdBQUcsQ0FBQ1o7WUFDcEIsRUFBRSxPQUFPSSxHQUFRO2dCQUNiSixZQUFZLENBQUMsa0JBQWtCLEVBQUVJLEVBQUVTLE9BQU8sQ0FBQyxDQUFDO1lBQ2hELFNBQVU7Z0JBQ050QixXQUFXdUIsS0FBSztZQUNwQjtRQUNKO0lBQ0o7SUFFQSxPQUFPLElBQUlDLFNBQVMzQixRQUFRO1FBQ3hCNEIsU0FBUztZQUNMLGdCQUFnQjtZQUNoQixxQkFBcUI7WUFDckIsaUJBQWlCO1lBQ2pCLFVBQVU7WUFDVixXQUFXO1lBQ1gsY0FBYztZQUNkLHFCQUFxQixLQUFLLHdDQUF3QztRQUN0RTtJQUNKO0FBQ0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmFuc2FjdGlvbmFsX2FnZW50Ly4vc3JjL2FwcC9hcGkvc3RyZWFtL3JvdXRlLnRzPzZkYzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhbnNhY3Rpb25hbEFnZW50IH0gZnJvbSBcIi4uLy4uLy4uL2FnZW50XCI7XG5cbi8vIEZvcmNlIGR5bmFtaWMgcHJldmVudHMgY2FjaGluZ1xuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSAnZm9yY2UtZHluYW1pYyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogUmVxdWVzdCkge1xuICAgIGNvbnNvbGUubG9nKFwiQVBJOiAvYXBpL3N0cmVhbSBjYWxsZWQgYXQgXCIgKyBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkpO1xuICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblxuICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgIGFzeW5jIHN0YXJ0KGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IHByaXZhdGVLZXkgPSBwcm9jZXNzLmVudi5QUklWQVRFX0tFWTtcbiAgICAgICAgICAgIGNvbnN0IHJwY1VybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1JQQ19VUkw7XG5cbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgQWdlbnRcbiAgICAgICAgICAgIC8vIE5PVEU6IEluIGEgcmVhbCBhcHAsIGRvIG5vdCBleHBvc2UgcHJpdmF0ZSBrZXkgaGFuZGxpbmcgdGhpcyB3YXkgaWYgcG9zc2libGUsIG9yIGVuc3VyZSBlbnZpcm9ubWVudCBpcyBzZWN1cmUuXG4gICAgICAgICAgICBjb25zdCBhZ2VudCA9IG5ldyBUcmFuc2FjdGlvbmFsQWdlbnQoe1xuICAgICAgICAgICAgICAgIHByaXZhdGVLZXk6IHByaXZhdGVLZXksXG4gICAgICAgICAgICAgICAgLy8gcnBjVXJsOiBycGNVcmwsIC8vIFJFTU9WRUQ6IFVzaW5nIGRlZmF1bHQgQmFzZSBTZXBvbGlhIFJQQyBmcm9tIGNsaWVudC50cyB0byBhdm9pZCBlbnYgdmFyIGNvbmZsaWN0XG4gICAgICAgICAgICAgICAgdXNlUmVhbFdhbGxldDogdHJ1ZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIExvZyBjYWxsYmFjayB0byBzdHJlYW0gZGF0YVxuICAgICAgICAgICAgY29uc3QgbG9nQ2FsbGJhY2sgPSAobXNnOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUobXNnICsgXCJcXG5cIikpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ29udHJvbGxlciBtaWdodCBiZSBjbG9zZWQgaWYgY2xpZW50IGRpc2Nvbm5lY3RlZFxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiU3RyZWFtIGNsb3NlZFwiLCBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBydW5JZCA9IERhdGUubm93KCkudG9TdHJpbmcoKSArIFwiLVwiICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMCk7XG4gICAgICAgICAgICBsb2dDYWxsYmFjayhgW1N5c3RlbV0g8J+GlCBSdW4gSUQ6ICR7cnVuSWR9YCk7XG4gICAgICAgICAgICBsb2dDYWxsYmFjayhgW1N5c3RlbV0g8J+VkCBUaW1lOiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1gKTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCBhZ2VudC5ydW4obG9nQ2FsbGJhY2spO1xuICAgICAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgICAgICAgbG9nQ2FsbGJhY2soYFtTeXN0ZW1dIOKdjCBFcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiBuZXcgUmVzcG9uc2Uoc3RyZWFtLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbjsgY2hhcnNldD11dGYtOCcsXG4gICAgICAgICAgICAnVHJhbnNmZXItRW5jb2RpbmcnOiAnY2h1bmtlZCcsXG4gICAgICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1zdG9yZSwgbm8tY2FjaGUsIG11c3QtcmV2YWxpZGF0ZSwgcHJveHktcmV2YWxpZGF0ZSwgbWF4LWFnZT0wJyxcbiAgICAgICAgICAgICdQcmFnbWEnOiAnbm8tY2FjaGUnLFxuICAgICAgICAgICAgJ0V4cGlyZXMnOiAnMCcsXG4gICAgICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJyxcbiAgICAgICAgICAgICdYLUFjY2VsLUJ1ZmZlcmluZyc6ICdubycgLy8gRGlzYWJsZSBOZ2lueCBidWZmZXJpbmcgaWYgYXBwbGljYWJsZVxuICAgICAgICB9LFxuICAgIH0pO1xufVxuIl0sIm5hbWVzIjpbIlRyYW5zYWN0aW9uYWxBZ2VudCIsImR5bmFtaWMiLCJHRVQiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsInN0cmVhbSIsIlJlYWRhYmxlU3RyZWFtIiwic3RhcnQiLCJjb250cm9sbGVyIiwicHJpdmF0ZUtleSIsInByb2Nlc3MiLCJlbnYiLCJQUklWQVRFX0tFWSIsInJwY1VybCIsIk5FWFRfUFVCTElDX1JQQ19VUkwiLCJhZ2VudCIsInVzZVJlYWxXYWxsZXQiLCJsb2dDYWxsYmFjayIsIm1zZyIsImVucXVldWUiLCJlbmNvZGUiLCJlIiwiZXJyb3IiLCJydW5JZCIsIm5vdyIsInRvU3RyaW5nIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicnVuIiwibWVzc2FnZSIsImNsb3NlIiwiUmVzcG9uc2UiLCJoZWFkZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/stream/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/x402/client.ts":
/*!****************************!*\
  !*** ./src/x402/client.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RealWallet: () => (/* binding */ RealWallet),\n/* harmony export */   X402Client: () => (/* binding */ X402Client)\n/* harmony export */ });\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/viem/_esm/clients/createWalletClient.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/viem/_esm/clients/transports/http.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/viem/_esm/clients/decorators/public.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/viem/_esm/utils/hash/keccak256.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/viem/_esm/clients/createPublicClient.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! viem */ \"(rsc)/./node_modules/abitype/dist/esm/human-readable/parseAbiItem.js\");\n/* harmony import */ var viem_accounts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! viem/accounts */ \"(rsc)/./node_modules/viem/_esm/accounts/privateKeyToAccount.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! viem/chains */ \"(rsc)/./node_modules/viem/_esm/chains/definitions/baseSepolia.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _x402_core_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @x402/core/client */ \"(rsc)/./node_modules/@x402/core/dist/esm/client/index.mjs\");\n/* harmony import */ var _x402_evm_exact_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @x402/evm/exact/client */ \"(rsc)/./node_modules/@x402/evm/dist/esm/exact/client/index.mjs\");\n/* harmony import */ var _x402_fetch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @x402/fetch */ \"(rsc)/./node_modules/@x402/fetch/dist/esm/index.mjs\");\n\n\n\n\nif (!globalThis.crypto) {\n    globalThis.crypto = (crypto__WEBPACK_IMPORTED_MODULE_0___default());\n}\n\n\n\nclass RealWallet {\n    constructor(privateKey, rpcUrl){\n        const formattedKey = privateKey.startsWith(\"0x\") ? privateKey : `0x${privateKey}`;\n        this.account = (0,viem_accounts__WEBPACK_IMPORTED_MODULE_4__.privateKeyToAccount)(formattedKey);\n        this.client = (0,viem__WEBPACK_IMPORTED_MODULE_5__.createWalletClient)({\n            account: this.account,\n            chain: viem_chains__WEBPACK_IMPORTED_MODULE_6__.baseSepolia,\n            transport: (0,viem__WEBPACK_IMPORTED_MODULE_7__.http)(rpcUrl || \"https://sepolia.base.org\")\n        }).extend(viem__WEBPACK_IMPORTED_MODULE_8__.publicActions);\n    }\n    // Legacy method for compatibility if needed, but x402 client handles payment now\n    async pay(recipient, amount, currency, log) {\n        throw new Error(\"Direct pay not supported in refactored client. Use X402Client.get()\");\n    }\n}\nclass X402Client {\n    constructor(baseUrl, wallet, logCallback){\n        this.currentOptions = null // Store selected options for hash lookup\n        ;\n        this.baseUrl = baseUrl.replace(/\\/$/, \"\"); // Normalize base URL\n        this.log = logCallback || ((msg)=>console.log(msg));\n        this.walletAddress = wallet.account.address;\n        // Initialize x402 Client with a simple network selector\n        this.x402 = new _x402_core_client__WEBPACK_IMPORTED_MODULE_1__.x402Client((_version, options)=>{\n            this.log(`[X402Client] üìã Available payment options: ${JSON.stringify(options)}`);\n            // Prefer Base Sepolia\n            const preferred = options.find((o)=>o.network === \"eip155:84532\") || options[0];\n            this.log(`[X402Client] ‚ú® Selected option: ${preferred.network} (${preferred.amount} ${preferred.asset || \"ETH\"})`);\n            // Capture chosen options for later use in hash lookup\n            this.currentOptions = preferred;\n            return preferred;\n        });\n        // Register EVM scheme with a wrapped signer (Account) to capture the transaction hash\n        // We intercept ALL signing methods to see what is actually used\n        const originalSigner = wallet.account;\n        const loggingSigner = {\n            ...originalSigner,\n            // Intercept signTransaction\n            signTransaction: async (args)=>{\n                this.log(`[X402Client] ‚úçÔ∏è Signing TRANSACTION...`);\n                // Force log directly to stdout to bypass any buffering issues\n                console.log(`[X402Client] ‚úçÔ∏è Signing TRANSACTION...`);\n                const signed = await originalSigner.signTransaction(args);\n                try {\n                    const txHash = (0,viem__WEBPACK_IMPORTED_MODULE_9__.keccak256)(signed);\n                    this.log(`[X402Client] üßæ Transaction Hash: ${txHash}`);\n                    this.log(`[X402Client] üîó Explorer: https://sepolia.basescan.org/tx/${txHash}`);\n                    console.log(`[X402Client] üßæ Transaction Hash: ${txHash}`);\n                } catch (err) {\n                    this.log(`[X402Client] ‚ö†Ô∏è Hash calc failed: ${err}`);\n                }\n                return signed;\n            },\n            // Intercept signMessage\n            signMessage: async (args)=>{\n                this.log(`[X402Client] ‚úçÔ∏è Signing MESSAGE...`);\n                console.log(`[X402Client] ‚úçÔ∏è Signing MESSAGE...`);\n                this.log(`[X402Client] ‚ÑπÔ∏è Message: ${args.message}`);\n                return originalSigner.signMessage(args);\n            },\n            // Intercept signTypedData\n            signTypedData: async (args)=>{\n                this.log(`[X402Client] ‚úçÔ∏è Signing TYPED DATA...`);\n                console.log(`[X402Client] ‚úçÔ∏è Signing TYPED DATA...`);\n                this.log(`[X402Client] ‚ÑπÔ∏è Domain: ${JSON.stringify(args.domain)}`);\n                return originalSigner.signTypedData(args);\n            }\n        };\n        (0,_x402_evm_exact_client__WEBPACK_IMPORTED_MODULE_2__.registerExactEvmScheme)(this.x402, {\n            signer: loggingSigner\n        });\n        this.log(\"[X402Client] \\uD83D\\uDE80 x402 Client setup complete with EVM scheme\");\n    }\n    async get(endpoint) {\n        const requestId = Math.floor(Math.random() * 10000);\n        const url = endpoint.startsWith(\"http\") ? endpoint : `${this.baseUrl}${endpoint.startsWith(\"/\") ? \"\" : \"/\"}${endpoint}`;\n        this.log(`[X402Client] [Req:${requestId}] üì§ GET ${url}`);\n        const startTime = Date.now();\n        // Capture start block to ensure we only find NEW transactions\n        let startBlock;\n        try {\n            // Force fresh block fetch using raw RPC call to bypass any viem/transport caching\n            const rpcUrl = \"https://sepolia.base.org\";\n            const blockResponse = await fetch(rpcUrl, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    jsonrpc: \"2.0\",\n                    method: \"eth_blockNumber\",\n                    params: [],\n                    id: requestId // Use request ID to trace this specific call\n                })\n            });\n            const blockData = await blockResponse.json();\n            startBlock = BigInt(blockData.result);\n            this.log(`[X402Client] [Req:${requestId}] ‚è±Ô∏è Start Block (Raw RPC): ${startBlock}`);\n        } catch (e) {\n            this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Could not get start block: ${e}`);\n        }\n        // Wrap fetch\n        const fetchWithPayment = (0,_x402_fetch__WEBPACK_IMPORTED_MODULE_3__.wrapFetchWithPayment)(fetch, this.x402);\n        try {\n            const response = await fetchWithPayment(url, {\n                method: \"GET\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n            this.log(`[X402Client] üì• Response Status: ${response.status}`);\n            let data;\n            const contentType = response.headers.get(\"content-type\");\n            if (contentType && contentType.includes(\"application/json\")) {\n                data = await response.json();\n            } else {\n                data = await response.text();\n            }\n            if (response.ok) {\n                // If payment successful, try to find the transaction hash from the blockchain\n                // because the x402 protocol / facilitator might not return it directly in the response\n                try {\n                    this.log(\"[X402Client] \\uD83D\\uDD0D Searching for transaction hash on-chain...\");\n                    // Create a public client to query logs\n                    const publicClient = (0,viem__WEBPACK_IMPORTED_MODULE_10__.createPublicClient)({\n                        chain: viem_chains__WEBPACK_IMPORTED_MODULE_6__.baseSepolia,\n                        transport: (0,viem__WEBPACK_IMPORTED_MODULE_7__.http)()\n                    });\n                    // Get latest block\n                    const blockNumber = await publicClient.getBlockNumber();\n                    // Look back 10 blocks (approx 20-30 seconds) for Transfer events\n                    // From: Payer (wallet.account.address), To: PayTo (options.payTo)\n                    if (this.currentOptions && this.currentOptions.asset && this.currentOptions.payTo) {\n                        const tokenAddress = this.currentOptions.asset;\n                        // We need access to the wallet address kept in the closure or passed in. \n                        // Wait, 'wallet' argument in constructor is not stored in 'this'. \n                        // But we registered the signer! 'this.x402' has the scheme registered.\n                        // Actually, let's just assume we can get it from the signer we wrapped earlier?\n                        // The wrapper 'loggingSigner' wrapped 'wallet.account'. \n                        // We can't easily access 'wallet.account' here unless we stored it.\n                        // Let's modify the class to store the wallet address in constructor.\n                        // NOTE: For this specific block replacement to work without changing constructor signature again,\n                        // I will rely on `this.walletAddress` which I will add in a separate edit or assume.\n                        // Actually, I can't add a property easily in a middle-of-file edit if I didn't add it in constructor.\n                        // I will assume `(this as any).walletAddress` is available after I patch the constructor,\n                        // OR better: I'll just use the property I added in the previous edit to `X402Client`.\n                        // Wait, I didn't store `wallet` in `X402Client`.\n                        // Let's rely on the fact that I can modify the constructor in the previous step to store wallet.\n                        const payerAddress = this.walletAddress;\n                        const merchantAddress = this.currentOptions.payTo;\n                        if (tokenAddress && payerAddress && merchantAddress) {\n                            await new Promise((resolve)=>setTimeout(resolve, 4000));\n                            const searchFromBlock = startBlock ? startBlock : blockNumber - 10n;\n                            // Polling loop for up to 30 seconds (10 attempts * 3s)\n                            for(let attempt = 1; attempt <= 10; attempt++){\n                                this.log(`[X402Client] [Req:${requestId}] üîÑ Attempt ${attempt}/10: Trawling logs...`);\n                                // Use 'latest' to avoid client cache returning a stale block number for the upper bound\n                                const logs = await publicClient.getLogs({\n                                    address: tokenAddress,\n                                    event: (0,viem__WEBPACK_IMPORTED_MODULE_11__.parseAbiItem)(\"event Transfer(address indexed from, address indexed to, uint256 value)\"),\n                                    args: {\n                                        from: payerAddress,\n                                        to: merchantAddress\n                                    },\n                                    fromBlock: searchFromBlock,\n                                    toBlock: \"latest\" // CRITICAL FIX: Use 'latest' instead of currentBlock (which might be cached/stale)\n                                });\n                                let foundFreshLog = false;\n                                // Iterate in reverse (newest first)\n                                if (logs.length > 0) {\n                                    for(let i = logs.length - 1; i >= 0; i--){\n                                        const log = logs[i];\n                                        // RELIABLE CHECK: Use Block Number AND Value\n                                        // If the log is in a block >= our startBlock, it IS new.\n                                        // We also verify the amount matches exactly to distinguish from other payments.\n                                        const expectedAmount = this.currentOptions.amount ? BigInt(this.currentOptions.amount) : 0n;\n                                        if (startBlock && log.blockNumber >= startBlock) {\n                                            // Additional check: Does the transfer amount match?\n                                            // log.args.value is a bigint\n                                            if (expectedAmount > 0n && log.args.value !== expectedAmount) {\n                                                this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Found fresh but ignoring due to amount mismatch (Log: ${log.args.value}, Expected: ${expectedAmount})`);\n                                                continue;\n                                            }\n                                            const txHash = log.transactionHash;\n                                            this.log(`[X402Client] [Req:${requestId}] ‚úÖ Found FRESH Transaction Hash: ${txHash}`);\n                                            this.log(`[X402Client] [Req:${requestId}]    Log Block: ${log.blockNumber}, Start: ${startBlock}, Amount: ${log.args.value}`);\n                                            this.log(`[X402Client] [Req:${requestId}] üîó Explorer: https://sepolia.basescan.org/tx/${txHash}`);\n                                            // Inject hash into response data\n                                            if (typeof data === \"object\" && data !== null && data.data) {\n                                                data.data.transactionHash = txHash;\n                                                data.data.network = \"eip155:84532\";\n                                            } else if (typeof data === \"object\" && data !== null) {\n                                                data.transactionHash = txHash;\n                                                data.network = \"eip155:84532\";\n                                            }\n                                            foundFreshLog = true;\n                                            break;\n                                        } else if (!startBlock) {\n                                            // Fallback if startBlock failed: accept the most recent one\n                                            // This is risky but better than nothing\n                                            const txHash = log.transactionHash;\n                                            this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Ambiguous Hash (No StartBlock): ${txHash}`);\n                                            if (typeof data === \"object\" && data !== null && data.data) {\n                                                data.data.transactionHash = txHash;\n                                            }\n                                            foundFreshLog = true;\n                                            break;\n                                        } else {\n                                        // Log implies it's < startBlock, so it's old.\n                                        // this.log(`[X402Client] üóëÔ∏è Ignored OLD log (Block ${log.blockNumber} < Start ${startBlock})`);\n                                        }\n                                    }\n                                }\n                                if (foundFreshLog) {\n                                    break; // Exit retry loop\n                                } else {\n                                    if (attempt < 10) {\n                                        this.log(`[X402Client] [Req:${requestId}] ‚è≥ No fresh logs yet. Waiting 3s...`);\n                                        await new Promise((resolve)=>setTimeout(resolve, 3000));\n                                    } else {\n                                        this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Timed out waiting for fresh Transfer events.`);\n                                    }\n                                }\n                            }\n                        }\n                    } else {\n                        this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Payment options missing: ${JSON.stringify(this.currentOptions)}`);\n                    }\n                } catch (e) {\n                    this.log(`[X402Client] [Req:${requestId}] ‚ö†Ô∏è Error searching for tx hash: ${e}`);\n                }\n            }\n            return {\n                status: response.status,\n                data: data,\n                headers: response.headers\n            };\n        } catch (error) {\n            this.log(`[X402Client] ‚ùå Error: ${error.message}`);\n            // Mimic axios error structure for compatibility\n            throw {\n                message: error.message,\n                response: {\n                    status: 500,\n                    data: error.message\n                }\n            };\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WyJ3ZWJwYWNrOi8vdHJhbnNhY3Rpb25hbF9hZ2VudC8uL3NyYy94NDAyL2NsaWVudC50cz9hMzFlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVdhbGxldENsaWVudCwgaHR0cCwgcHVibGljQWN0aW9ucywga2VjY2FrMjU2LCBjcmVhdGVQdWJsaWNDbGllbnQsIHBhcnNlQWJpSXRlbSB9IGZyb20gJ3ZpZW0nO1xuaW1wb3J0IHsgcHJpdmF0ZUtleVRvQWNjb3VudCB9IGZyb20gJ3ZpZW0vYWNjb3VudHMnO1xuaW1wb3J0IHsgYmFzZVNlcG9saWEgfSBmcm9tICd2aWVtL2NoYWlucyc7XG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5cbmlmICghZ2xvYmFsVGhpcy5jcnlwdG8pIHtcbiAgICBnbG9iYWxUaGlzLmNyeXB0byA9IGNyeXB0byBhcyBhbnk7XG59XG5cbmltcG9ydCB7IHg0MDJDbGllbnQgfSBmcm9tICdAeDQwMi9jb3JlL2NsaWVudCc7XG5pbXBvcnQgeyByZWdpc3RlckV4YWN0RXZtU2NoZW1lIH0gZnJvbSAnQHg0MDIvZXZtL2V4YWN0L2NsaWVudCc7XG5pbXBvcnQgeyB3cmFwRmV0Y2hXaXRoUGF5bWVudCB9IGZyb20gJ0B4NDAyL2ZldGNoJztcbmltcG9ydCB0eXBlIHsgUGF5bWVudFJlcXVpcmVtZW50cyB9IGZyb20gJ0B4NDAyL2NvcmUvdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUmVhbFdhbGxldCB7XG4gICAgcHVibGljIGNsaWVudDtcbiAgICBwdWJsaWMgYWNjb3VudDtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGVLZXk6IHN0cmluZywgcnBjVXJsPzogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZEtleSA9IHByaXZhdGVLZXkuc3RhcnRzV2l0aCgnMHgnKSA/IHByaXZhdGVLZXkgOiBgMHgke3ByaXZhdGVLZXl9YDtcbiAgICAgICAgdGhpcy5hY2NvdW50ID0gcHJpdmF0ZUtleVRvQWNjb3VudChmb3JtYXR0ZWRLZXkgYXMgYDB4JHtzdHJpbmd9YCk7XG4gICAgICAgIHRoaXMuY2xpZW50ID0gY3JlYXRlV2FsbGV0Q2xpZW50KHtcbiAgICAgICAgICAgIGFjY291bnQ6IHRoaXMuYWNjb3VudCxcbiAgICAgICAgICAgIGNoYWluOiBiYXNlU2Vwb2xpYSxcbiAgICAgICAgICAgIHRyYW5zcG9ydDogaHR0cChycGNVcmwgfHwgJ2h0dHBzOi8vc2Vwb2xpYS5iYXNlLm9yZycpXG4gICAgICAgIH0pLmV4dGVuZChwdWJsaWNBY3Rpb25zKTtcbiAgICB9XG5cbiAgICAvLyBMZWdhY3kgbWV0aG9kIGZvciBjb21wYXRpYmlsaXR5IGlmIG5lZWRlZCwgYnV0IHg0MDIgY2xpZW50IGhhbmRsZXMgcGF5bWVudCBub3dcbiAgICBhc3luYyBwYXkocmVjaXBpZW50OiBzdHJpbmcsIGFtb3VudDogc3RyaW5nLCBjdXJyZW5jeTogc3RyaW5nLCBsb2c/OiAobXNnOiBzdHJpbmcpID0+IHZvaWQpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEaXJlY3QgcGF5IG5vdCBzdXBwb3J0ZWQgaW4gcmVmYWN0b3JlZCBjbGllbnQuIFVzZSBYNDAyQ2xpZW50LmdldCgpXCIpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFg0MDJDbGllbnQge1xuICAgIHByaXZhdGUgeDQwMjogeDQwMkNsaWVudDtcbiAgICBwcml2YXRlIGxvZzogKG1zZzogc3RyaW5nKSA9PiB2b2lkO1xuICAgIHByaXZhdGUgY3VycmVudE9wdGlvbnM6IGFueSA9IG51bGw7IC8vIFN0b3JlIHNlbGVjdGVkIG9wdGlvbnMgZm9yIGhhc2ggbG9va3VwXG5cbiAgICBwcml2YXRlIGJhc2VVcmw6IHN0cmluZztcbiAgICBwcml2YXRlIHdhbGxldEFkZHJlc3M6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmw6IHN0cmluZywgd2FsbGV0OiBSZWFsV2FsbGV0LCBsb2dDYWxsYmFjaz86IChtc2c6IHN0cmluZykgPT4gdm9pZCkge1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsLnJlcGxhY2UoL1xcLyQvLCAnJyk7IC8vIE5vcm1hbGl6ZSBiYXNlIFVSTFxuICAgICAgICB0aGlzLmxvZyA9IGxvZ0NhbGxiYWNrIHx8ICgobXNnKSA9PiBjb25zb2xlLmxvZyhtc2cpKTtcbiAgICAgICAgdGhpcy53YWxsZXRBZGRyZXNzID0gd2FsbGV0LmFjY291bnQuYWRkcmVzcztcblxuICAgICAgICAvLyBJbml0aWFsaXplIHg0MDIgQ2xpZW50IHdpdGggYSBzaW1wbGUgbmV0d29yayBzZWxlY3RvclxuICAgICAgICB0aGlzLng0MDIgPSBuZXcgeDQwMkNsaWVudCgoX3ZlcnNpb24sIG9wdGlvbnMpID0+IHtcbiAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0g8J+TiyBBdmFpbGFibGUgcGF5bWVudCBvcHRpb25zOiAke0pTT04uc3RyaW5naWZ5KG9wdGlvbnMpfWApO1xuICAgICAgICAgICAgLy8gUHJlZmVyIEJhc2UgU2Vwb2xpYVxuICAgICAgICAgICAgY29uc3QgcHJlZmVycmVkID0gb3B0aW9ucy5maW5kKG8gPT4gby5uZXR3b3JrID09PSAnZWlwMTU1Ojg0NTMyJykgfHwgb3B0aW9uc1swXTtcbiAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0g4pyoIFNlbGVjdGVkIG9wdGlvbjogJHtwcmVmZXJyZWQubmV0d29ya30gKCR7cHJlZmVycmVkLmFtb3VudH0gJHtwcmVmZXJyZWQuYXNzZXQgfHwgJ0VUSCd9KWApO1xuXG4gICAgICAgICAgICAvLyBDYXB0dXJlIGNob3NlbiBvcHRpb25zIGZvciBsYXRlciB1c2UgaW4gaGFzaCBsb29rdXBcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE9wdGlvbnMgPSBwcmVmZXJyZWQ7XG5cbiAgICAgICAgICAgIHJldHVybiBwcmVmZXJyZWQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIEVWTSBzY2hlbWUgd2l0aCBhIHdyYXBwZWQgc2lnbmVyIChBY2NvdW50KSB0byBjYXB0dXJlIHRoZSB0cmFuc2FjdGlvbiBoYXNoXG4gICAgICAgIC8vIFdlIGludGVyY2VwdCBBTEwgc2lnbmluZyBtZXRob2RzIHRvIHNlZSB3aGF0IGlzIGFjdHVhbGx5IHVzZWRcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxTaWduZXIgPSB3YWxsZXQuYWNjb3VudDtcbiAgICAgICAgY29uc3QgbG9nZ2luZ1NpZ25lciA9IHtcbiAgICAgICAgICAgIC4uLm9yaWdpbmFsU2lnbmVyLFxuICAgICAgICAgICAgLy8gSW50ZXJjZXB0IHNpZ25UcmFuc2FjdGlvblxuICAgICAgICAgICAgc2lnblRyYW5zYWN0aW9uOiBhc3luYyAoYXJnczogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDinI3vuI8gU2lnbmluZyBUUkFOU0FDVElPTi4uLmApO1xuICAgICAgICAgICAgICAgIC8vIEZvcmNlIGxvZyBkaXJlY3RseSB0byBzdGRvdXQgdG8gYnlwYXNzIGFueSBidWZmZXJpbmcgaXNzdWVzXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtYNDAyQ2xpZW50XSDinI3vuI8gU2lnbmluZyBUUkFOU0FDVElPTi4uLmApO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpZ25lZCA9IGF3YWl0IG9yaWdpbmFsU2lnbmVyLnNpZ25UcmFuc2FjdGlvbihhcmdzKTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0eEhhc2ggPSBrZWNjYWsyNTYoc2lnbmVkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDwn6e+IFRyYW5zYWN0aW9uIEhhc2g6ICR7dHhIYXNofWApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIPCflJcgRXhwbG9yZXI6IGh0dHBzOi8vc2Vwb2xpYS5iYXNlc2Nhbi5vcmcvdHgvJHt0eEhhc2h9YCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbWDQwMkNsaWVudF0g8J+nviBUcmFuc2FjdGlvbiBIYXNoOiAke3R4SGFzaH1gKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDimqDvuI8gSGFzaCBjYWxjIGZhaWxlZDogJHtlcnJ9YCk7IH1cbiAgICAgICAgICAgICAgICByZXR1cm4gc2lnbmVkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIEludGVyY2VwdCBzaWduTWVzc2FnZVxuICAgICAgICAgICAgc2lnbk1lc3NhZ2U6IGFzeW5jIChhcmdzOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIOKcje+4jyBTaWduaW5nIE1FU1NBR0UuLi5gKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW1g0MDJDbGllbnRdIOKcje+4jyBTaWduaW5nIE1FU1NBR0UuLi5gKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIOKEue+4jyBNZXNzYWdlOiAke2FyZ3MubWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxTaWduZXIuc2lnbk1lc3NhZ2UoYXJncyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLy8gSW50ZXJjZXB0IHNpZ25UeXBlZERhdGFcbiAgICAgICAgICAgIHNpZ25UeXBlZERhdGE6IGFzeW5jIChhcmdzOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIOKcje+4jyBTaWduaW5nIFRZUEVEIERBVEEuLi5gKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW1g0MDJDbGllbnRdIOKcje+4jyBTaWduaW5nIFRZUEVEIERBVEEuLi5gKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIOKEue+4jyBEb21haW46ICR7SlNPTi5zdHJpbmdpZnkoYXJncy5kb21haW4pfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbFNpZ25lci5zaWduVHlwZWREYXRhKGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHJlZ2lzdGVyRXhhY3RFdm1TY2hlbWUodGhpcy54NDAyLCB7XG4gICAgICAgICAgICBzaWduZXI6IGxvZ2dpbmdTaWduZXJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5sb2coXCJbWDQwMkNsaWVudF0g8J+agCB4NDAyIENsaWVudCBzZXR1cCBjb21wbGV0ZSB3aXRoIEVWTSBzY2hlbWVcIik7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGdldChlbmRwb2ludDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHJlcXVlc3RJZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKTtcbiAgICAgICAgY29uc3QgdXJsID0gZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cCcpID8gZW5kcG9pbnQgOiBgJHt0aGlzLmJhc2VVcmx9JHtlbmRwb2ludC5zdGFydHNXaXRoKCcvJykgPyAnJyA6ICcvJ30ke2VuZHBvaW50fWA7XG4gICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0gW1JlcToke3JlcXVlc3RJZH1dIPCfk6QgR0VUICR7dXJsfWApO1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIC8vIENhcHR1cmUgc3RhcnQgYmxvY2sgdG8gZW5zdXJlIHdlIG9ubHkgZmluZCBORVcgdHJhbnNhY3Rpb25zXG4gICAgICAgIGxldCBzdGFydEJsb2NrOiBiaWdpbnQgfCB1bmRlZmluZWQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBGb3JjZSBmcmVzaCBibG9jayBmZXRjaCB1c2luZyByYXcgUlBDIGNhbGwgdG8gYnlwYXNzIGFueSB2aWVtL3RyYW5zcG9ydCBjYWNoaW5nXG4gICAgICAgICAgICBjb25zdCBycGNVcmwgPSAnaHR0cHM6Ly9zZXBvbGlhLmJhc2Uub3JnJztcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChycGNVcmwsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdldGhfYmxvY2tOdW1iZXInLFxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBpZDogcmVxdWVzdElkIC8vIFVzZSByZXF1ZXN0IElEIHRvIHRyYWNlIHRoaXMgc3BlY2lmaWMgY2FsbFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrRGF0YSA9IGF3YWl0IGJsb2NrUmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgc3RhcnRCbG9jayA9IEJpZ0ludChibG9ja0RhdGEucmVzdWx0KTtcbiAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0gW1JlcToke3JlcXVlc3RJZH1dIOKPse+4jyBTdGFydCBCbG9jayAoUmF3IFJQQyk6ICR7c3RhcnRCbG9ja31gKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSBbUmVxOiR7cmVxdWVzdElkfV0g4pqg77iPIENvdWxkIG5vdCBnZXQgc3RhcnQgYmxvY2s6ICR7ZX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdyYXAgZmV0Y2hcbiAgICAgICAgY29uc3QgZmV0Y2hXaXRoUGF5bWVudCA9IHdyYXBGZXRjaFdpdGhQYXltZW50KGZldGNoLCB0aGlzLng0MDIpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoV2l0aFBheW1lbnQodXJsLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDwn5OlIFJlc3BvbnNlIFN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG5cbiAgICAgICAgICAgIGxldCBkYXRhO1xuICAgICAgICAgICAgY29uc3QgY29udGVudFR5cGUgPSByZXNwb25zZS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJyk7XG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGUgJiYgY29udGVudFR5cGUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIC8vIElmIHBheW1lbnQgc3VjY2Vzc2Z1bCwgdHJ5IHRvIGZpbmQgdGhlIHRyYW5zYWN0aW9uIGhhc2ggZnJvbSB0aGUgYmxvY2tjaGFpblxuICAgICAgICAgICAgICAgIC8vIGJlY2F1c2UgdGhlIHg0MDIgcHJvdG9jb2wgLyBmYWNpbGl0YXRvciBtaWdodCBub3QgcmV0dXJuIGl0IGRpcmVjdGx5IGluIHRoZSByZXNwb25zZVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKFwiW1g0MDJDbGllbnRdIPCflI0gU2VhcmNoaW5nIGZvciB0cmFuc2FjdGlvbiBoYXNoIG9uLWNoYWluLi4uXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHB1YmxpYyBjbGllbnQgdG8gcXVlcnkgbG9nc1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwdWJsaWNDbGllbnQgPSBjcmVhdGVQdWJsaWNDbGllbnQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhaW46IGJhc2VTZXBvbGlhLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNwb3J0OiBodHRwKClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGxhdGVzdCBibG9ja1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9ja051bWJlciA9IGF3YWl0IHB1YmxpY0NsaWVudC5nZXRCbG9ja051bWJlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIExvb2sgYmFjayAxMCBibG9ja3MgKGFwcHJveCAyMC0zMCBzZWNvbmRzKSBmb3IgVHJhbnNmZXIgZXZlbnRzXG4gICAgICAgICAgICAgICAgICAgIC8vIEZyb206IFBheWVyICh3YWxsZXQuYWNjb3VudC5hZGRyZXNzKSwgVG86IFBheVRvIChvcHRpb25zLnBheVRvKVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRPcHRpb25zICYmIHRoaXMuY3VycmVudE9wdGlvbnMuYXNzZXQgJiYgdGhpcy5jdXJyZW50T3B0aW9ucy5wYXlUbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9rZW5BZGRyZXNzID0gdGhpcy5jdXJyZW50T3B0aW9ucy5hc3NldCBhcyBgMHgke3N0cmluZ31gO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCBhY2Nlc3MgdG8gdGhlIHdhbGxldCBhZGRyZXNzIGtlcHQgaW4gdGhlIGNsb3N1cmUgb3IgcGFzc2VkIGluLiBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdhaXQsICd3YWxsZXQnIGFyZ3VtZW50IGluIGNvbnN0cnVjdG9yIGlzIG5vdCBzdG9yZWQgaW4gJ3RoaXMnLiBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ1dCB3ZSByZWdpc3RlcmVkIHRoZSBzaWduZXIhICd0aGlzLng0MDInIGhhcyB0aGUgc2NoZW1lIHJlZ2lzdGVyZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBY3R1YWxseSwgbGV0J3MganVzdCBhc3N1bWUgd2UgY2FuIGdldCBpdCBmcm9tIHRoZSBzaWduZXIgd2Ugd3JhcHBlZCBlYXJsaWVyP1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHdyYXBwZXIgJ2xvZ2dpbmdTaWduZXInIHdyYXBwZWQgJ3dhbGxldC5hY2NvdW50Jy4gXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBjYW4ndCBlYXNpbHkgYWNjZXNzICd3YWxsZXQuYWNjb3VudCcgaGVyZSB1bmxlc3Mgd2Ugc3RvcmVkIGl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGV0J3MgbW9kaWZ5IHRoZSBjbGFzcyB0byBzdG9yZSB0aGUgd2FsbGV0IGFkZHJlc3MgaW4gY29uc3RydWN0b3IuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IEZvciB0aGlzIHNwZWNpZmljIGJsb2NrIHJlcGxhY2VtZW50IHRvIHdvcmsgd2l0aG91dCBjaGFuZ2luZyBjb25zdHJ1Y3RvciBzaWduYXR1cmUgYWdhaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJIHdpbGwgcmVseSBvbiBgdGhpcy53YWxsZXRBZGRyZXNzYCB3aGljaCBJIHdpbGwgYWRkIGluIGEgc2VwYXJhdGUgZWRpdCBvciBhc3N1bWUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBY3R1YWxseSwgSSBjYW4ndCBhZGQgYSBwcm9wZXJ0eSBlYXNpbHkgaW4gYSBtaWRkbGUtb2YtZmlsZSBlZGl0IGlmIEkgZGlkbid0IGFkZCBpdCBpbiBjb25zdHJ1Y3Rvci5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEkgd2lsbCBhc3N1bWUgYCh0aGlzIGFzIGFueSkud2FsbGV0QWRkcmVzc2AgaXMgYXZhaWxhYmxlIGFmdGVyIEkgcGF0Y2ggdGhlIGNvbnN0cnVjdG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT1IgYmV0dGVyOiBJJ2xsIGp1c3QgdXNlIHRoZSBwcm9wZXJ0eSBJIGFkZGVkIGluIHRoZSBwcmV2aW91cyBlZGl0IHRvIGBYNDAyQ2xpZW50YC5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdhaXQsIEkgZGlkbid0IHN0b3JlIGB3YWxsZXRgIGluIGBYNDAyQ2xpZW50YC5cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGV0J3MgcmVseSBvbiB0aGUgZmFjdCB0aGF0IEkgY2FuIG1vZGlmeSB0aGUgY29uc3RydWN0b3IgaW4gdGhlIHByZXZpb3VzIHN0ZXAgdG8gc3RvcmUgd2FsbGV0LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGF5ZXJBZGRyZXNzID0gKHRoaXMgYXMgYW55KS53YWxsZXRBZGRyZXNzIGFzIGAweCR7c3RyaW5nfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXJjaGFudEFkZHJlc3MgPSB0aGlzLmN1cnJlbnRPcHRpb25zLnBheVRvIGFzIGAweCR7c3RyaW5nfWA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbkFkZHJlc3MgJiYgcGF5ZXJBZGRyZXNzICYmIG1lcmNoYW50QWRkcmVzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA0MDAwKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWFyY2hGcm9tQmxvY2sgPSBzdGFydEJsb2NrID8gc3RhcnRCbG9jayA6IChibG9ja051bWJlciAtIDEwbik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb2xsaW5nIGxvb3AgZm9yIHVwIHRvIDMwIHNlY29uZHMgKDEwIGF0dGVtcHRzICogM3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gMTA7IGF0dGVtcHQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIFtSZXE6JHtyZXF1ZXN0SWR9XSDwn5SEIEF0dGVtcHQgJHthdHRlbXB0fS8xMDogVHJhd2xpbmcgbG9ncy4uLmApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSAnbGF0ZXN0JyB0byBhdm9pZCBjbGllbnQgY2FjaGUgcmV0dXJuaW5nIGEgc3RhbGUgYmxvY2sgbnVtYmVyIGZvciB0aGUgdXBwZXIgYm91bmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9ncyA9IGF3YWl0IHB1YmxpY0NsaWVudC5nZXRMb2dzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IHRva2VuQWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBwYXJzZUFiaUl0ZW0oJ2V2ZW50IFRyYW5zZmVyKGFkZHJlc3MgaW5kZXhlZCBmcm9tLCBhZGRyZXNzIGluZGV4ZWQgdG8sIHVpbnQyNTYgdmFsdWUpJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogcGF5ZXJBZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvOiBtZXJjaGFudEFkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tQmxvY2s6IHNlYXJjaEZyb21CbG9jayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQmxvY2s6ICdsYXRlc3QnIC8vIENSSVRJQ0FMIEZJWDogVXNlICdsYXRlc3QnIGluc3RlYWQgb2YgY3VycmVudEJsb2NrICh3aGljaCBtaWdodCBiZSBjYWNoZWQvc3RhbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZEZyZXNoTG9nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXRlcmF0ZSBpbiByZXZlcnNlIChuZXdlc3QgZmlyc3QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2dzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBsb2dzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9nID0gbG9nc1tpXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJFTElBQkxFIENIRUNLOiBVc2UgQmxvY2sgTnVtYmVyIEFORCBWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBsb2cgaXMgaW4gYSBibG9jayA+PSBvdXIgc3RhcnRCbG9jaywgaXQgSVMgbmV3LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGFsc28gdmVyaWZ5IHRoZSBhbW91bnQgbWF0Y2hlcyBleGFjdGx5IHRvIGRpc3Rpbmd1aXNoIGZyb20gb3RoZXIgcGF5bWVudHMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWRBbW91bnQgPSB0aGlzLmN1cnJlbnRPcHRpb25zLmFtb3VudCA/IEJpZ0ludCh0aGlzLmN1cnJlbnRPcHRpb25zLmFtb3VudCkgOiAwbjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydEJsb2NrICYmIGxvZy5ibG9ja051bWJlciA+PSBzdGFydEJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgY2hlY2s6IERvZXMgdGhlIHRyYW5zZmVyIGFtb3VudCBtYXRjaD9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9nLmFyZ3MudmFsdWUgaXMgYSBiaWdpbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkQW1vdW50ID4gMG4gJiYgbG9nLmFyZ3MudmFsdWUgIT09IGV4cGVjdGVkQW1vdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIFtSZXE6JHtyZXF1ZXN0SWR9XSDimqDvuI8gRm91bmQgZnJlc2ggYnV0IGlnbm9yaW5nIGR1ZSB0byBhbW91bnQgbWlzbWF0Y2ggKExvZzogJHtsb2cuYXJncy52YWx1ZX0sIEV4cGVjdGVkOiAke2V4cGVjdGVkQW1vdW50fSlgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHhIYXNoID0gbG9nLnRyYW5zYWN0aW9uSGFzaDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIFtSZXE6JHtyZXF1ZXN0SWR9XSDinIUgRm91bmQgRlJFU0ggVHJhbnNhY3Rpb24gSGFzaDogJHt0eEhhc2h9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0gW1JlcToke3JlcXVlc3RJZH1dICAgIExvZyBCbG9jazogJHtsb2cuYmxvY2tOdW1iZXJ9LCBTdGFydDogJHtzdGFydEJsb2NrfSwgQW1vdW50OiAke2xvZy5hcmdzLnZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIFtSZXE6JHtyZXF1ZXN0SWR9XSDwn5SXIEV4cGxvcmVyOiBodHRwczovL3NlcG9saWEuYmFzZXNjYW4ub3JnL3R4LyR7dHhIYXNofWApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluamVjdCBoYXNoIGludG8gcmVzcG9uc2UgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEgIT09IG51bGwgJiYgKGRhdGEgYXMgYW55KS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGF0YSBhcyBhbnkpLmRhdGEudHJhbnNhY3Rpb25IYXNoID0gdHhIYXNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGRhdGEgYXMgYW55KS5kYXRhLm5ldHdvcmsgPSBcImVpcDE1NTo4NDUzMlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JyAmJiBkYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGF0YSBhcyBhbnkpLnRyYW5zYWN0aW9uSGFzaCA9IHR4SGFzaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkYXRhIGFzIGFueSkubmV0d29yayA9IFwiZWlwMTU1Ojg0NTMyXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRGcmVzaExvZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXN0YXJ0QmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgaWYgc3RhcnRCbG9jayBmYWlsZWQ6IGFjY2VwdCB0aGUgbW9zdCByZWNlbnQgb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgcmlza3kgYnV0IGJldHRlciB0aGFuIG5vdGhpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHhIYXNoID0gbG9nLnRyYW5zYWN0aW9uSGFzaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSBbUmVxOiR7cmVxdWVzdElkfV0g4pqg77iPIEFtYmlndW91cyBIYXNoIChObyBTdGFydEJsb2NrKTogJHt0eEhhc2h9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgJiYgZGF0YSAhPT0gbnVsbCAmJiAoZGF0YSBhcyBhbnkpLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChkYXRhIGFzIGFueSkuZGF0YS50cmFuc2FjdGlvbkhhc2ggPSB0eEhhc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRGcmVzaExvZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvZyBpbXBsaWVzIGl0J3MgPCBzdGFydEJsb2NrLCBzbyBpdCdzIG9sZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDwn5eR77iPIElnbm9yZWQgT0xEIGxvZyAoQmxvY2sgJHtsb2cuYmxvY2tOdW1iZXJ9IDwgU3RhcnQgJHtzdGFydEJsb2NrfSlgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmRGcmVzaExvZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7IC8vIEV4aXQgcmV0cnkgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGVtcHQgPCAxMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0gW1JlcToke3JlcXVlc3RJZH1dIOKPsyBObyBmcmVzaCBsb2dzIHlldC4gV2FpdGluZyAzcy4uLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAzMDAwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nKGBbWDQwMkNsaWVudF0gW1JlcToke3JlcXVlc3RJZH1dIOKaoO+4jyBUaW1lZCBvdXQgd2FpdGluZyBmb3IgZnJlc2ggVHJhbnNmZXIgZXZlbnRzLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSBbUmVxOiR7cmVxdWVzdElkfV0g4pqg77iPIFBheW1lbnQgb3B0aW9ucyBtaXNzaW5nOiAke0pTT04uc3RyaW5naWZ5KHRoaXMuY3VycmVudE9wdGlvbnMpfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZyhgW1g0MDJDbGllbnRdIFtSZXE6JHtyZXF1ZXN0SWR9XSDimqDvuI8gRXJyb3Igc2VhcmNoaW5nIGZvciB0eCBoYXNoOiAke2V9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogcmVzcG9uc2UuaGVhZGVyc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgdGhpcy5sb2coYFtYNDAyQ2xpZW50XSDinYwgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIC8vIE1pbWljIGF4aW9zIGVycm9yIHN0cnVjdHVyZSBmb3IgY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgdGhyb3cge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2U6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiA1MDAsIC8vIFVua25vd24gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZXJyb3IubWVzc2FnZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlV2FsbGV0Q2xpZW50IiwiaHR0cCIsInB1YmxpY0FjdGlvbnMiLCJrZWNjYWsyNTYiLCJjcmVhdGVQdWJsaWNDbGllbnQiLCJwYXJzZUFiaUl0ZW0iLCJwcml2YXRlS2V5VG9BY2NvdW50IiwiYmFzZVNlcG9saWEiLCJjcnlwdG8iLCJnbG9iYWxUaGlzIiwieDQwMkNsaWVudCIsInJlZ2lzdGVyRXhhY3RFdm1TY2hlbWUiLCJ3cmFwRmV0Y2hXaXRoUGF5bWVudCIsIlJlYWxXYWxsZXQiLCJjb25zdHJ1Y3RvciIsInByaXZhdGVLZXkiLCJycGNVcmwiLCJmb3JtYXR0ZWRLZXkiLCJzdGFydHNXaXRoIiwiYWNjb3VudCIsImNsaWVudCIsImNoYWluIiwidHJhbnNwb3J0IiwiZXh0ZW5kIiwicGF5IiwicmVjaXBpZW50IiwiYW1vdW50IiwiY3VycmVuY3kiLCJsb2ciLCJFcnJvciIsIlg0MDJDbGllbnQiLCJiYXNlVXJsIiwid2FsbGV0IiwibG9nQ2FsbGJhY2siLCJjdXJyZW50T3B0aW9ucyIsInJlcGxhY2UiLCJtc2ciLCJjb25zb2xlIiwid2FsbGV0QWRkcmVzcyIsImFkZHJlc3MiLCJ4NDAyIiwiX3ZlcnNpb24iLCJvcHRpb25zIiwiSlNPTiIsInN0cmluZ2lmeSIsInByZWZlcnJlZCIsImZpbmQiLCJvIiwibmV0d29yayIsImFzc2V0Iiwib3JpZ2luYWxTaWduZXIiLCJsb2dnaW5nU2lnbmVyIiwic2lnblRyYW5zYWN0aW9uIiwiYXJncyIsInNpZ25lZCIsInR4SGFzaCIsImVyciIsInNpZ25NZXNzYWdlIiwibWVzc2FnZSIsInNpZ25UeXBlZERhdGEiLCJkb21haW4iLCJzaWduZXIiLCJnZXQiLCJlbmRwb2ludCIsInJlcXVlc3RJZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInVybCIsInN0YXJ0VGltZSIsIkRhdGUiLCJub3ciLCJzdGFydEJsb2NrIiwiYmxvY2tSZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJqc29ucnBjIiwicGFyYW1zIiwiaWQiLCJibG9ja0RhdGEiLCJqc29uIiwiQmlnSW50IiwicmVzdWx0IiwiZSIsImZldGNoV2l0aFBheW1lbnQiLCJyZXNwb25zZSIsInN0YXR1cyIsImRhdGEiLCJjb250ZW50VHlwZSIsImluY2x1ZGVzIiwidGV4dCIsIm9rIiwicHVibGljQ2xpZW50IiwiYmxvY2tOdW1iZXIiLCJnZXRCbG9ja051bWJlciIsInBheVRvIiwidG9rZW5BZGRyZXNzIiwicGF5ZXJBZGRyZXNzIiwibWVyY2hhbnRBZGRyZXNzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0Iiwic2VhcmNoRnJvbUJsb2NrIiwiYXR0ZW1wdCIsImxvZ3MiLCJnZXRMb2dzIiwiZXZlbnQiLCJmcm9tIiwidG8iLCJmcm9tQmxvY2siLCJ0b0Jsb2NrIiwiZm91bmRGcmVzaExvZyIsImxlbmd0aCIsImkiLCJleHBlY3RlZEFtb3VudCIsInZhbHVlIiwidHJhbnNhY3Rpb25IYXNoIiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/x402/client.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/viem","vendor-chunks/ox","vendor-chunks/abitype","vendor-chunks/@noble","vendor-chunks/@x402"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fstream%2Froute&page=%2Fapi%2Fstream%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fstream%2Froute.ts&appDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichalwanto%2FDocuments%2FMichal_wanto%2FWork%2FSynergy_test%2FTransactional_agent&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();